\subsubsection{Trieæ ‘}
\begin{verbatim}
struct Trie{
    int cnt, head;
    char ch[MAX_M];
    int g[MAX_M], next[MAX_M];

    void init(){
        head = 1;
        cnt = 1;
    }

    inline int getnext(int p){
        return next[p];
    }

    int &operator[](const int &idx){
        return g[idx];
    }

    int getson(int node, char c){
        int p = g[node];
        while (p && ch[p] != c) p = next[p];
        return p;
    }

    int insert(int node, char c){
        ++cnt;
        g[cnt] = 0;
        ch[cnt] = c;
        next[cnt] = g[node];
        g[node] = cnt;
        return cnt;
    }
} trie;

\end{verbatim}
